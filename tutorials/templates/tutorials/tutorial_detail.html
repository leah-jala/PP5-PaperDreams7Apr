{% extends "base.html" %}
{% load static %}

{% block extra_meta %}
<meta name="description" content="Learn how to make a bespoke mask with our expert guidance. 
    Get inspired by beginner to advanced projects. Start your papier-mache journey today!">
{% endblock %}

{% block extra_css %}
<style>
  .tutorial-post-link {
    color: black;
    text-decoration: none;
  }
  .tutorial-post-link.active {
    color: green;
    font-weight: bold;
  }
  .image-responsive {
    max-width: 100%;
    height: auto;
  }

  @media only screen and (min-width: 768px) and (max-width: 991px) {
  .week-post {
    padding: 0;
    margin: 0;
  }

  .week-post img {
    width: calc(100% - 20px); /* Adjust width as needed */
    margin: 0 10px; /* Adjust margins as needed */
  }
}
</style>
{% endblock %}


{% block extra_js %}
{% endblock %}

{% block extra_title%}Tutorials{% endblock %}

{% block page_header %}
<div class="container header-container">
  <div class="row">
    <div class="col"></div>
  </div>
</div>

{% endblock %}

{% block content %}
<h2>Tutorials</h2>

<div class="container p-4">
  <!-- First row -->
  <div class="container d-flex flex-row flex-wrap justify-content-center">
    <div class="col-md-12 card mb-4 mt-3 tutorial">
      <div class="row px-2">
        <div class="col-md-3">
          <img src="{{ object.image.url }}" class="card-img-top py-4" alt="{{ object.image_alt }}">
        </div>
        <div class="col-md-9 card-body">
          <h3>{{ object.title }}</h3>
          <h4>Instructor: {{ object.instructor }}</h4>
          <p><small><strong>Category: {{ object.category.get_friendly_name }}</strong></small></p>
          <p></p>
          <p><strong>Duration:</strong> {{ object.duration }}</p>
          <p class="text-capitalize"><strong>Difficulty:</strong> {{ tutorial.difficulty_level }}</p>
          <p><strong>Summary:</strong> {{ object.summary }}</p>
          <div class="d-flex flex-wrap tutorial-links-container">
            {% for post in tutorial_posts %}
            <a href="#" class="tutorial-post-link mr-2 mb-2" data-week="{{ post.week_number }}">Week {{ post.week_number }} - {{ post.title }}</a>
            {% if not forloop.last %}<span class="separator">|&nbsp</span>{% endif %}
            {% endfor %}
          </div>                
        </div>
      </div>
      <!-- Second row -->
      <div class="row px-2">
        <div class="col-md-3">
          <h5><strong>Equipment List</strong></h5>
          {{ object.equipment_list | safe }}
        </div>
        <div class="col-md-9">
          <!-- Tutorial posts -->
          <div id="card-body tutorial-posts">
            {% for post in tutorial_posts %}
              <div id="week-{{ post.week_number }}" class="pb-3 week-post row" style="display: none;">
                  <h4>{{ post.title }}</h4>
                  <img src="{{ post.image.url }}" alt="{{ post.image_alt }}" class="p-4 rounded float-right image-responsive">
                  <p>{{ post.instructions | safe }}</p>
              </div>            
            {% endfor %}
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block postloadjs %}
<script>
  document.addEventListener("DOMContentLoaded", function() {
    const postLinks = document.querySelectorAll(".tutorial-post-link");
    const weekPosts = document.querySelectorAll(".week-post");

    // Show the first week by default
    if (weekPosts.length > 0) {
      weekPosts[0].style.display = "block";
    }

    // Add the 'active' class to the first link by default
    if (postLinks.length > 0) {
      postLinks[0].classList.add("active");
    }

    postLinks.forEach(link => {
      link.addEventListener("click", event => {
        event.preventDefault();
        const weekNumber = link.dataset.week;

        // Remove the 'active' class from all the links
        postLinks.forEach(link => link.classList.remove("active"));

        // Add the 'active' class to the clicked link
        event.target.classList.add("active");

        weekPosts.forEach(post => {
          if (post.id === `week-${weekNumber}`) {
            post.style.display = "block";
          } else {
            post.style.display = "none";
          }
        });
      });
    });
  });
</script>
{% endblock %}
